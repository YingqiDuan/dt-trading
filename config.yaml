data:
  exchange: binance  # ccxt exchange id (e.g., binance)
  symbol: BTC/USDT
  timeframe: 15m  # 1m|3m|5m|15m|30m|1h|2h|4h|6h|8h|12h|1d|3d|1w|1M
  since: "2023-01-01"
  until: "2025-12-31"
  train_end: "2024-12-31"
  val_end: "2025-06-30"  # optional; if omitted, defaults to train_end
  test_end: "2025-12-31"
  limit: 1000
  raw_dir: data/raw
  feature_dir: data/features
  integrity:
    enabled: true
    gap_policy: fill  # fill|warn|error
    max_gap_bars: 1000

features:
  volatility_window: 24
  ma_window: 24
  ema_windows: [3, 6, 9, 12, 15, 18]
  boll_window: 12
  boll_n_std: 4.0
  macd_fast: 12
  macd_slow: 24
  macd_signal: 9
  rsi_window: 14
  volume_z_window: 24
  log_return_cum_windows: [16, 96]  # 4h, 1d when timeframe=15m
  zscore_window: 96
  skip_zscore: [boll_z]
  include_log_return: true  # true|false
  include_log_return_cum: true  # true|false
  include_volatility: true  # true|false
  include_volume: true  # true|false
  include_ema: true  # true|false
  include_boll: true  # true|false
  include_macd: true  # true|false
  include_price_to_ma: false  # true|false
  include_rsi: false  # true|false

rewards:
  fee: 0.0004
  slip: 0.0002
  price_mode: ohlc4  # close|open|hl2|oc2|ohlc4|typical
  range_penalty: 0.0

dataset:
  seq_len: 128  # try 64 if memory/throughput is tight
  episode_len: 512  # null = full window
  behavior_policy: ema_trend  # ema_trend|random|buy_hold|flat
  rtg_gamma: 1.0
  rtg_scale: 1.0
  target_return: 0.0

train:
  mode: offline  # offline|ppo
  batch_size: 64
  epochs: 100
  lr: 0.0003
  weight_decay: 0.0001
  d_model: 128
  n_layers: 4
  n_heads: 4
  dropout: 0.1
  grad_clip: 1.0
  rollout_progress: true
  update_progress: true
  eval_progress: true
  device: auto  # auto|cpu|cuda
  log_dir: outputs/train
  checkpoint_dir: outputs/checkpoints

rl:
  seed: 42
  action_mode: continuous  # discrete|continuous
  action_dim: 1
  gamma: 0.99  # fallback if dataset.rtg_gamma is not set
  reward_scale: 100.0
  turnover_penalty: 0.0
  position_penalty: 0.0
  drawdown_penalty: 0.0
  eval_every: 1
  eval_mode: deterministic  # deterministic|sample
  eval_samples: 5
  eval_seed: 42
  # PPO knobs (unused by offline DT)
  rollout_steps: 8192
  ppo_epochs: 3
  minibatch_size: 256
  gae_lambda: 0.95
  clip_range: 0.15
  value_coef: 0.5
  entropy_coef: 0.02

backtest:
  initial_cash: 10000
  fee: 0.0004
  slip: 0.0002
  risk_free: 0.0
  ema_deadzone: 0.001
  random_stay_prob: 0.5
  baseline_seed: 42
  output_dir: outputs/backtest

papertrade:
  base_url: "https://fapi.binance.com"  # https://fapi.binance.com | https://demo-fapi.binance.com
  symbol: "BTCUSDT"
  interval: "1h"  # 1m|3m|5m|15m|30m|1h|2h|4h|6h|8h|12h|1d|3d|1w|1M
  trade_qty: 0.001
  dry_run: true  # true|false
  poll_seconds: 10
  max_drawdown_pct: 0.3
  log_path: outputs/papertrade/trade_log.csv
  api_key_env: "BINANCE_API_KEY"
  api_secret_env: "BINANCE_API_SECRET"

walk_forward:
  enabled: false  # true|false
  train_bars: 4320
  val_bars: 720
  test_bars: 720
  step_bars: 720
  max_folds: 0  # 0 = all possible
  output_dir: outputs/walk_forward
